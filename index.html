<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Image Number Extractor</title>
    <script src="https://cdn.jsdelivr.net/npm/tesseract.js@v2.1.1/dist/tesseract.min.js"></script>
    <style>
        body {
            font-family: Arial, sans-serif;
        }
        #output {
            margin-top: 20px;
        }
    </style>
</head>
<body>
    <h1>Image Number Extractor</h1>
    <input type="file" id="imageUpload" accept="image/*" />
    <button onclick="processImage()">Extract Numbers</button>

    <div id="output"></div>

    <script>
        function processImage() {
            const file = document.getElementById('imageUpload').files[0];
            if (!file) {
                alert('Please upload an image.');
                return;
            }

            // Create a new FileReader to read the image
            const reader = new FileReader();
            reader.onload = function(event) {
                // Use Tesseract.js to extract text from the image
                Tesseract.recognize(
                    event.target.result,
                    'eng',
                    { logger: (m) => console.log(m) }
                ).then(({ data: { text } }) => {
                    extractAndCalculate(text);
                });
            };
            reader.readAsDataURL(file);
        }

        function extractAndCalculate(text) {
            // Regular expression to find numbers in the format 1,111.11
            const regex = /\d{1,3}(,\d{3})*(\.\d{2})?/g;
            const numbers = text.match(regex);

            if (!numbers || numbers.length === 0) {
                document.getElementById('output').innerHTML = "No numbers found.";
                return;
            }

            let outputHTML = "<h2>Results</h2><ul>";
            numbers.forEach(number => {
                // Remove commas to treat as a floating point number
                const numericValue = parseFloat(number.replace(/,/g, ''));
                const percentage = numericValue * 0.16;
                const total = numericValue + percentage;

                outputHTML += `<li>Original: ${number}, 16%: ${percentage.toFixed(2)}, Total: ${total.toFixed(2)}</li>`;
            });
            outputHTML += "</ul>";

            document.getElementById('output').innerHTML = outputHTML;
        }
    </script>
</body>
</html>
